# WS63 项目结构分析

## 项目概述

这是一个基于 **HiSpark WS63 平台**的嵌入式项目，使用了 **Huawei LiteOS** 操作系统。项目采用 CMake 构建系统，支持多种编译选项和调试配置。

- **许可证**: Apache 2.0
- **开发平台**: HiSpark WS63
- **操作系统**: Huawei LiteOS
- **构建工具**: CMake, Python (build.py)

---

## 目录结构

```
.vscode/          # VSCode IDE 配置
analyzerJson/     # 代码分析和质量控制配置
application/      # 应用层代码
bootloader/       # 引导加载程序
build/            # CMake 构建系统配置
drivers/          # 设备驱动程序
include/          # 公共头文件
interim_binary/   # 编译中间二进制文件
kernel/           # 内核 (LiteOS)
libs_url/         # 第三方库 URL 配置
middleware/       # 中间件服务
open_source/      # 开源组件
output/           # 编译输出目录
protocol/         # 通信协议栈
tools/            # 开发工具
```

---

## 核心模块详解

### 1. application/ - 应用层
应用代码的顶层目录，包含具体业务逻辑实现。
- `samples/` - 示例代码
- `ws63/` - WS63 平台特定应用代码
- 配置文件: `CMakeLists.txt`, `Kconfig`

### 2. bootloader/ - 引导加载程序
系统启动时首先运行的代码，负责初始化硬件和加载主程序。
- `commonboot/` - 通用引导代码
- `flashboot_ws63/` - WS63 平台闪存引导
- `provision_ws63/` - WS63 平台配置代码

### 3. kernel/ - 内核层
提供操作系统核心功能和硬件抽象。
- `liteos/` - Huawei LiteOS 操作系统内核
- `non_os/` - 无操作系统支持（裸机模式）
- `osal/` - 操作系统抽象层
- `osal_adapt/` - OS 适配层

功能: 任务调度、内存管理、进程间通信等

### 4. drivers/ - 设备驱动程序
硬件驱动和板级支持包。
- `adapter/` - 驱动适配层
- `boards/` - 板级支持包 (BSP)
- `chips/` - 芯片相关驱动
- `drivers/` - 具体驱动实现

### 5. protocol/ - 通信协议栈
各种通信协议的实现。
- `bt/` - 蓝牙协议栈
- `wifi/` - Wi-Fi 协议栈
- `radar/` - 雷达相关协议

### 6. middleware/ - 中间件
介于操作系统和应用之间的服务组件。
- `chips/` - 芯片相关中间件
- `services/` - 各种服务组件
- `utils/` - 工具库和通用函数

---

## 配置与工具

### build/ - 构建系统
CMake 构建配置，包含编译规则和菜单配置。

### include/ - 公共头文件
- `driver/` - 驱动头文件
- `middleware/` - 中间件头文件
- `common_def.h` - 通用定义
- `errcode.h` - 错误码定义
- `cfbb_version.h` - 版本信息

### tools/ - 开发工具
- `bin/` - 可执行工具
- `pkg/` - 工具包

---

## 临时文件与输出

| 目录 | 用途 |
|------|------|
| `output/` | 编译生成的二进制文件、可执行文件 |
| `interim_binary/` | 编译过程中的中间文件 |

---

## 构建系统

### 构建入口: build.py

```bash
# 基本编译
python build.py

# 清理后编译
python build.py -c

# 多线程编译
python build.py -j 8

# 定义宏
python build.py -def MACRO_NAME=value

# 指定编译组件
python build.py -component component_name

# 使用 ninja 构建
python build.py -ninja
```

### 项目配置文件
- `CMakeLists.txt` - CMake 主配置文件
- `fbb_ws63.hiproj` - HiSpark Studio 项目配置
- `config.in` - Kconfig 配置入口
- `LICENSE` - Apache 2.0 许可证

---

## 项目架构

```
┌─────────────────────────────────────┐
│         Application Layer           │
│         (application/)              │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Middleware & Protocol          │
│   (middleware/, protocol/)          │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│           Kernel & OSAL             │
│          (kernel/)                  │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│         Drivers (HAL)               │
│         (drivers/)                  │
└─────────────────────────────────────┘
```

---

## 适用场景

本项目架构适用于：
- 物联网设备开发
- 嵌入式系统开发
- 支持蓝牙、Wi-Fi、雷达等通信功能的智能设备

---

*文档生成日期: 2026-01-08*
